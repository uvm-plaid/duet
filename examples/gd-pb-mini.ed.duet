-- gradient descent
-- per-iteration bound
-- with minibatching
let main = pÎ» m  : â„•,
              n  : â„•,
              Îµ  : â„âº,
              k  : â„•,
              Î´  : â„âº,
              Î´â€² : â„âº,
              b  : â„•
              .
              xs : ğ•„ [Lâˆ, U|m, nâ‹…ğ”» ] ,
              ys : ğ•„ [Lâˆ, U|m, 1â‹…ğ”» ] ,
              Îµ  : â„âº[Îµ],
              k  : â„•[k],
              Î´  : â„âº[Î´],
              Î´â€² : â„âº[Î´â€²],
              Î·  : â„,
              b  : â„•[b]
              â‡’
  let mâ‚€ = mcreate[ L2 | â„•[1] , cols xs ] { i , j â‡’ 0.0 } in
  let b = â„•[50] in
  aloop[ Î´â€² ] k on mâ‚€ <xs,ys> { t , Î¸ â‡’
    g â† sample[ b ] xs, ys {xs', ys' â‡’
        let s = â„âº[1.0] / real (rows xs') in
        mgauss[ s , Îµ , Î´ ] <xs',ys'> { âˆ‡[ LR | Î¸ ; mclip[L2] xs' , ys' ] } };
    return Î¸ - Î· â‹… g
  }
in main
