-- gradient descent
-- total bound
let main = pÎ» m  : â„•,
              n  : â„•,
              Îµ  : â„âº,
              k  : â„•,
              Î´  : â„âº,
              Î´â€²  : â„âº,
              Î·  : â„âº
              .
              xs : ğ•„ [L2 U|m,n] ğ”» ,
              ys : ğ•„ [L2 U|m,1] ğ”» ,
              Îµ  : â„âº[Îµ],
              k : â„•[k],
              Î´ : â„âº[Î´],
              Î´â€² : â„âº[Î´â€²],
              Î· : â„âº[Î·]
              â‡’
  let k  = â„•[1000] in
  let Îµáµ¢ = Îµ / (â„âº[2.0] â‹… âˆš (â„âº[2.0] â‹… k â‹… (ã’ (1/Î´â€²)))) in
  let Î´áµ¢ = Î´ / (â„âº[2.0] â‹… k) in
  let Î·  = â„âº[0.1] in
  let mâ‚€ = mcreate[ L2 | â„•[1] , cols xs ] { i , j â‡’ 0.0 } in
  aloop[ Î´â€² ] k on mâ‚€ <xs,ys> { a, Î¸ â‡’ 
    let s = â„âº[1.0] / real (rows xs) in
    g â† mgauss[ s , Îµáµ¢ , Î´áµ¢ ] <xs,ys> { âˆ‡[ LR | Î¸ ; clip[L2] xs, ys ] } ;
    return Î¸ - Î· â‹… g
  }
in main

