-- the command line interface we want
--
--     `duet run <this-file> "data.csv" "labels.csv" 0.05 100 0.0001 0.0001 1`
--
-- gradient descent
-- per-iteration bound
let main = pÎ» m  : â„•,
              n  : â„•,
              Îµ  : â„âº,
              k  : â„•,
              Î´  : â„âº,
              Î´â€² : â„âº
              .
              xs : ğ•„ [Lâˆ, U|m, nâ‹…ğ”» ] ,
              ys : ğ•„ [Lâˆ, U|m, 1â‹…ğ”» ] ,
              Îµ  : â„âº[Îµ],
              k  : â„•[k],
              Î´  : â„âº[Î´],
              Î´â€² : â„âº[Î´â€²],
              Î·  : â„
              â‡’
  let mâ‚€ = mcreate[ Lâˆ | â„•[1] , cols xs ] { i , j â‡’ 0.0 } in
  let c = box (mclip[L2] xs) in
  aloop[ Î´â€² ] k on mâ‚€ <xs,ys> { a, Î¸ â‡’
    let s = â„âº[1.0] / real (rows xs) in
    g â† mgauss[ s , Îµ , Î´ ] <xs,ys> { âˆ‡[ LR | Î¸ ; unbox c , ys ] } ;
    return mmap Î¸ , mmap g { x â‡’ Î· â‹… x } { x , y â‡’ x - y }
  }
-- in main
in return main
-- in return (pÎ» . 
--               xs : ğ•„ [Lâˆ, U|1000, 10â‹…ğ”» ] ,
--               ys : ğ•„ [Lâˆ, U|1000, 10â‹…ğ”» ] ,
--               Îµ  : â„âº[0.001],
--               k  : â„•[100],
--               Î´  : â„âº[0.0001],
--               Î´â€² : â„âº[0.0001],
--               Î·  : â„ â‡’
--             main@[ 1000 , 10 , 0.001 , 100 , 0.0001 , 0.0001 ](xs, ys, Îµ, k, Î´, Î´â€², Î·))
